<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Configurar Sala — Questions Multiplayer</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <main class="centered-card">
    <header class="card-header">
      <h1>Configurar Sala</h1>
      <p class="subtitle">Ajuste as regras antes de começar.</p>
    </header>

    <section class="card-body">
      <div class="form-row">
        <label>Sala</label>
        <input id="roomName" disabled>
      </div>

      <div class="form-row">
        <label>Senha</label>
        <input id="roomPassword" disabled>
      </div>

      <hr style="border-color: #f0e68c; opacity:0.3;">

      <div class="form-row">
        <label for="questionCount">Quantidade de perguntas</label>
        <select id="questionCount">
          <option value="5">5</option>
          <option value="10" selected>10</option>
          <option value="15">15</option>
          <option value="20">20</option>
        </select>
      </div>

      <div class="form-row">
        <label for="timeLimit">Tempo por pergunta (segundos)</label>
        <select id="timeLimit">
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="20" selected>20</option>
          <option value="30">30</option>
        </select>
      </div>

      <div class="form-row">
        <label>Modo</label>
        <select id="mode">
          <option value="normal" selected>Normal</option>
          <option value="hard">Difícil</option>
          <option value="chaos">Caótico</option>
        </select>
      </div>

      <div class="form-row">
        <label>Privacidade</label>
        <select id="privacy">
          <option value="private" selected>Privada (senha obrigatória)</option>
          <option value="public">Pública</option>
        </select>
      </div>

      <div class="form-row hidden" id="codigoPrivadoWrapper">
        <label>Código Privado</label>
        <input id="codigoPrivado" placeholder="Ex: 1234">
      </div>

      <hr style="border-color: #f0e68c; opacity:0.3;">

      <button id="btn-start" class="btn primary full">Iniciar Jogo</button>
      <button id="btn-back" class="btn ghost full">Voltar</button>
    </section>

    <footer class="card-footer">
      <small>Configurações aplicam apenas para esta sala</small>
    </footer>
  </main>

  <script>
    const url = new URL(location.href);
    const room = url.searchParams.get('room') || '';
    const password = url.searchParams.get('password') || '';
    const isHost = url.searchParams.get('host') === 'true';

    const roomNameInput = document.getElementById('roomName');
    const roomPasswordInput = document.getElementById('roomPassword');
    const privacySelect = document.getElementById('privacy');
    const codigoWrapper = document.getElementById('codigoPrivadoWrapper');

    roomNameInput.value = room;
    roomPasswordInput.value = password;

    if(!isHost){
      alert('Apenas o criador da sala pode configurar.');
      location.href = '/index.html';
    }

    privacySelect.addEventListener('change', ()=>{
      if(privacySelect.value === 'private'){
        codigoWrapper.classList.remove('hidden');
      } else {
        codigoWrapper.classList.add('hidden');
      }
    });

    document.getElementById('btn-start').addEventListener('click', ()=>{
      const params = new URLSearchParams();
      params.set('room', room);
      params.set('password', password);
      params.set('questions', document.getElementById('questionCount').value);
      params.set('time', document.getElementById('timeLimit').value);
      params.set('mode', document.getElementById('mode').value);
      params.set('privacy', document.getElementById('privacy').value);
      if(document.getElementById('codigoPrivado').value)
        params.set('privateCode', document.getElementById('codigoPrivado').value);

      location.href = '/game.html?' + params.toString();
    });

    document.getElementById('btn-back').addEventListener('click', ()=>{
      location.href = '/index.html';
    });
  </script>
</body>
</html>
