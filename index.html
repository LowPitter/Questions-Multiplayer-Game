<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Teste do Milhão</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="centered-card" id="card">
    <header class="card-header">
      <h1>Teste do Milhão</h1>
      <p class="subtitle">Crie ou entre em uma sala para jogar.</p>
    </header>

    <section class="card-body">

      <!-- Tela inicial com botões -->
      <div id="initial-buttons">
        <button id="btn-create-room" class="primary full">Criar Sala</button>
        <button id="btn-join-room" class="ghost full">Entrar em Sala</button>
      </div>

      <!-- Formulário de criar/entrar sala -->
      <div id="room-form" class="hidden">
        <div class="form-row">
          <label for="roomNameInput">Nome da Sala</label>
          <input type="text" id="roomNameInput" placeholder="Ex: SalaDoPedro">
        </div>

        <div class="checkbox-row">
          <input type="checkbox" id="privateCheck">
          <label for="privateCheck">Privada</label>
        </div>

        <div class="form-row hidden" id="passwordRow">
          <label for="roomPasswordInput">Senha</label>
          <input type="password" id="roomPasswordInput" placeholder="Senha da sala">
        </div>

        <div class="controls-row">
          <button id="submitRoom" class="primary full"></button>
          <button id="btn-back" class="ghost full">Voltar</button>
        </div>
      </div>

    </section>

    <footer class="card-footer">
      <small>Feito por você • Hospedado no GitHub Pages</small>
    </footer>
  </main>

  <script>
    const card = document.getElementById("card");
    const initialButtons = document.getElementById("initial-buttons");
    const roomForm = document.getElementById("room-form");
    const submitRoom = document.getElementById("submitRoom");
    const btnBack = document.getElementById("btn-back");
    const privateCheck = document.getElementById("privateCheck");
    const passwordRow = document.getElementById("passwordRow");
    const roomNameInput = document.getElementById("roomNameInput");
    const roomPasswordInput = document.getElementById("roomPasswordInput");

    let actionType = ""; // "create" ou "join"

    // Mostrar formulário de criar sala
    document.getElementById("btn-create-room").onclick = () => {
      actionType = "create";
      initialButtons.classList.add("hidden");
      roomForm.classList.remove("hidden");
      submitRoom.textContent = "Criar Sala";
      card.classList.add("full-screen");
    };

    // Mostrar formulário de entrar em sala
    document.getElementById("btn-join-room").onclick = () => {
      actionType = "join";
      initialButtons.classList.add("hidden");
      roomForm.classList.remove("hidden");
      submitRoom.textContent = "Entrar na Sala";
      card.classList.add("full-screen");
    };

    // Mostrar/ocultar campo senha
    privateCheck.onchange = () => {
      if(privateCheck.checked){
        passwordRow.classList.remove("hidden");
      } else {
        passwordRow.classList.add("hidden");
      }
    };

    // Voltar para tela inicial
    btnBack.onclick = () => {
      roomForm.classList.add("hidden");
      initialButtons.classList.remove("hidden");
      card.classList.remove("full-screen");
      roomNameInput.value = "";
      roomPasswordInput.value = "";
      privateCheck.checked = false;
      passwordRow.classList.add("hidden");
    };

    // Submeter ação (criar ou entrar)
    submitRoom.onclick = () => {
      const roomName = roomNameInput.value.trim();
      const password = roomPasswordInput.value.trim();

      if(!roomName){
        alert("Digite o nome da sala!");
        return;
      }

      if(privateCheck.checked && password.length < 1){
        alert("Digite a senha da sala!");
        return;
      }

      const params = new URLSearchParams();
      params.set("room", roomName);
      if(privateCheck.checked) params.set("password", password);

      if(actionType === "create"){
        params.set("host", "true");
        window.location.href = "/config.html?" + params.toString();
      } else if(actionType === "join"){
        window.location.href = "/game.html?" + params.toString();
      }
    };
  </script>
</body>
</html>
